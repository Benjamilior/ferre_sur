import requests
#No olvidarse del key.json
#Buscar todos los "Cambiar" antes de usar
#En chatgpt cruzar sku_dotu con links. Pedir que te haga el json desde el info del sheets
import json
import time
import datetime
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
from selenium.common.exceptions import NoSuchElementException
from selenium.common.exceptions import StaleElementReferenceException

import pandas as pd

import gspread
from oauth2client.service_account import ServiceAccountCredentials
from google.oauth2.credentials import Credentials
from googleapiclient.discovery import build
from google.oauth2 import service_account

#Google Sheets
SCOPES = ['https://www.googleapis.com/auth/spreadsheets']
KEY = 'key.json' #Cambiar check
SPREADSHEET_ID = '1l2jZGmnAZN7Y8cELYIP_6eeKvBz9ivrJLgW5faYvMs0' #Cambiar check
creds = None
creds = service_account.Credentials.from_service_account_file(KEY, scopes=SCOPES)
service = build('sheets', 'v4', credentials=creds)
sheet = service.spreadsheets()


# PATH = "C:\\Program Files (x86)\\chromedriver.exe"
PATH = "/usr/local/bin/chromedriver"
# Configurar las opciones de Chrome
chrome_options = Options()
chrome_options.add_argument("--headless")  # Ver el Navegador
chrome_options.add_argument("--window-size=1920x1080")
start_time = time.time()  # Tiempo de inicio de la ejecución
driver = webdriver.Chrome(options=chrome_options)

url = "https://api.retailrocket.net/api/1.0/partner/6387b69af73ae8e6f24584f6/items"

# Especifica la lista de artículos en formato de diccionario
item_skus = {
    "Ferresurdotu1": "6843",
    "Ferresurdotu2": "4034",
    "Ferresurdotu3": "5870",
    "Ferresurdotu4": "9472",
    "Ferresurdotu5": "10989",
    "Ferresurdotu6": "2612",
    "Ferresurdotu7": "7755",
    "Ferresurdotu8": "1648",
    "Ferresurdotu9": "7290",
    "Ferresurdotu10": "2563",
    "Ferresurdotu11": "9338",
    "Ferresurdotu12": "4589",
    "Ferresurdotu13": "4495",
    "Ferresurdotu14": "6607",
    "Ferresurdotu15": "3511",
    "Ferresurdotu16": "13149",
    "Ferresurdotu17": "3253",
    "Ferresurdotu18": "1111",
    "Ferresurdotu21": "3437",
    "Ferresurdotu22": "11799",
    "Ferresurdotu24": "5155",
    "Ferresurdotu25": "1668",
    "Ferresurdotu26": "6840",
    "Ferresurdotu27": "12415",
    "Ferresurdotu28": "3799",
    "Ferresurdotu29": "1859",
    "Ferresurdotu31": "586",
    "Ferresurdotu33": "128",
    "Ferresurdotu34": "4776",
    "Ferresurdotu35": "10428",
    "Ferresurdotu36": "2483",
    "Ferresurdotu37": "8736",
    "Ferresurdotu38": "3557",
    "Ferresurdotu39": "8959",
    "Ferresurdotu40": "6040",
    "Ferresurdotu41": "4879",
    "Ferresurdotu42": "5631",
    "Ferresurdotu43": "3808",
    "Ferresurdotu44": "3353",
    "Ferresurdotu45": "11617",
    "Ferresurdotu46": "4325",
    "Ferresurdotu47": "5126",
    "Ferresurdotu49": "10164",
    "Ferresurdotu50": "10173",
    "Ferresurdotu51": "9779",
    "Ferresurdotu52": "3663",
    "Ferresurdotu53": "10874",
    "Ferresurdotu54": "4336",
    "Ferresurdotu55": "6419",
    "Ferresurdotu56": "6036",
    "Ferresurdotu57": "1252",
    "Ferresurdotu58": "2225",
    "Ferresurdotu59": "11091",
    "Ferresurdotu60": "12025",
    "Ferresurdotu61": "1329",
    "Ferresurdotu62": "5739",
    "Ferresurdotu63": "6335",
    "Ferresurdotu64": "8794",
    "Ferresurdotu65": "3060",
    "Ferresurdotu66": "10920",
    "Ferresurdotu67": "8877",
    "Ferresurdotu69": "1663",
    "Ferresurdotu70": "11997",
    "Ferresurdotu71": "10450",
    "Ferresurdotu72": "1185",
    "Ferresurdotu73": "9299",
    "Ferresurdotu74": "10560",
    "Ferresurdotu75": "12024",
    "Ferresurdotu76": "7575",
    "Ferresurdotu77": "3558",
    "Ferresurdotu78": "5069",
    "Ferresurdotu79": "8127",
    "Ferresurdotu80": "5228",
    "Ferresurdotu82": "10766",
    "Ferresurdotu83": "12398",
    "Ferresurdotu84": "10796",
    "Ferresurdotu85": "9780",
    "Ferresurdotu86": "6283",
    "Ferresurdotu87": "2587",
    "Ferresurdotu88": "6487",
    "Ferresurdotu89": "128",
    "Ferresurdotu90": "2464",
    "Ferresurdotu91": "8037",
    "Ferresurdotu92": "5527",
    "Ferresurdotu93": "185",
    "Ferresurdotu94": "10018",
    "Ferresurdotu95": "6093",
    "Ferresurdotu96": "9912",
    "Ferresurdotu97": "9479",
    "Ferresurdotu98": "11440",
    "Ferresurdotu99": "184",
    "Ferresurdotu100": "5143",
    "Ferresurdotu101": "5192",
    "Ferresurdotu102": "8741",
    "Ferresurdotu103": "517",
    "Ferresurdotu104": "6336",
    "Ferresurdotu105": "768",
    "Ferresurdotu106": "12004",
    "Ferresurdotu107": "5524",
    "Ferresurdotu108": "366",
    "Ferresurdotu109": "7162",
    "Ferresurdotu110": "6023",
    "Ferresurdotu111": "5499",
    "Ferresurdotu112": "10877",
    "Ferresurdotu113": "11800",
    "Ferresurdotu114": "145",
    "Ferresurdotu116": "3955",
    "Ferresurdotu117": "5113",
    "Ferresurdotu118": "8565",
    "Ferresurdotu119": "1906",
    "Ferresurdotu120": "3175",
    "Ferresurdotu121": "531",
    "Ferresurdotu122": "1013",
    "Ferresurdotu123": "10559",
    "Ferresurdotu124": "406",
    "Ferresurdotu125": "5167",
    "Ferresurdotu126": "7371",
    "Ferresurdotu127": "6539",
    "Ferresurdotu130": "10572",
    "Ferresurdotu131": "11251",
    "Ferresurdotu132": "2621",
    "Ferresurdotu133": "10392",
    "Ferresurdotu134": "4002",
    "Ferresurdotu135": "1968",
    "Ferresurdotu136": "129",
    "Ferresurdotu137": "11040",
    "Ferresurdotu138": "3706",
    "Ferresurdotu139": "5322",
    "Ferresurdotu140": "12040",
    "Ferresurdotu141": "2699",
    "Ferresurdotu142": "5147",
    "Ferresurdotu143": "1590",
    "Ferresurdotu144": "11993",
    "Ferresurdotu145": "264",
    "Ferresurdotu146": "4770",
    "Ferresurdotu147": "6318",
    "Ferresurdotu148": "9658",
    "Ferresurdotu149": "8063",
    "Ferresurdotu150": "1033",
    "Ferresurdotu151": "10530",
    "Ferresurdotu152": "4691",
    "Ferresurdotu153": "1082",
    "Ferresurdotu154": "12395",
    "Ferresurdotu155": "6228",
    "Ferresurdotu157": "5208",
    "Ferresurdotu158": "8935",
    "Ferresurdotu159": "9489",
    "Ferresurdotu160": "5770",
    "Ferresurdotu161": "9632",
    "Ferresurdotu162": "6420",
    "Ferresurdotu163": "1453",
    "Ferresurdotu164": "12845",
    "Ferresurdotu165": "10995",
    "Ferresurdotu167": "3254",
    "Ferresurdotu168": "4003",
    "Ferresurdotu169": "11384",
    "Ferresurdotu170": "1126",
    "Ferresurdotu171": "10486",
    "Ferresurdotu172": "5949",
    "Ferresurdotu173": "13327",
    "Ferresurdotu174": "11996",
    "Ferresurdotu175": "592",
    "Ferresurdotu176": "12414",
    "Ferresurdotu177": "12041",
    "Ferresurdotu178": "3174",
    "Ferresurdotu179": "8044",
    "Ferresurdotu180": "209",
    "Ferresurdotu181": "7890",
    "Ferresurdotu182": "3843",
    "Ferresurdotu183": "12431",
    "Ferresurdotu184": "4605",
    "Ferresurdotu185": "1703",
    "Ferresurdotu186": "10409",
    "Ferresurdotu189": "10021",
    "Ferresurdotu190": "8443",
    "Ferresurdotu191": "5132",
    "Ferresurdotu192": "10557",
    "Ferresurdotu193": "568",
    "Ferresurdotu194": "7180",
    "Ferresurdotu195": "6525",
    "Ferresurdotu196": "10308",
    "Ferresurdotu197": "1683",
    "Ferresurdotu198": "907",
    "Ferresurdotu200": "3633",
    "Ferresurdotu201": "12741",
    "Ferresurdotu202": "8317",
    "Ferresurdotu203": "12172",
    "Ferresurdotu204": "4474",
    "Ferresurdotu205": "12167",
    "Ferresurdotu207": "6869",
    "Ferresurdotu208": "521",
    "Ferresurdotu209": "2014",
    "Ferresurdotu210": "4760",
    "Ferresurdotu211": "9539",
    "Ferresurdotu212": "12016",
    "Ferresurdotu213": "7717",
    "Ferresurdotu214": "1788",
    "Ferresurdotu215": "11994",
    "Ferresurdotu216": "11142",
    "Ferresurdotu217": "10450",
    "Ferresurdotu218": "1892",
    "Ferresurdotu219": "9395",
    "Ferresurdotu221": "12413",
    "Ferresurdotu222": "10589",
    "Ferresurdotu223": "6058",
    "Ferresurdotu224": "8740",
    "Ferresurdotu225": "9032",
    "Ferresurdotu226": "490",
    "Ferresurdotu227": "4775",
    "Ferresurdotu228": "11571",
    "Ferresurdotu229": "3007",
    "Ferresurdotu230": "6749",
    "Ferresurdotu231": "10151",
    "Ferresurdotu232": "3996",
    "Ferresurdotu233": "6124",
    "Ferresurdotu234": "8513",
    "Ferresurdotu235": "7838",
    "Ferresurdotu236": "8778",
    "Ferresurdotu237": "1598",
    "Ferresurdotu238": "3148",
    "Ferresurdotu239": "4674",
    "Ferresurdotu240": "8726",
    "Ferresurdotu241": "1020",
    "Ferresurdotu243": "3384",
    "Ferresurdotu244": "13054",
    "Ferresurdotu245": "9857",
    "Ferresurdotu246": "9839",
    "Ferresurdotu247": "5185",
    "Ferresurdotu248": "6175",
    "Ferresurdotu250": "6524",
    "Ferresurdotu251": "3770",
    "Ferresurdotu252": "5120",
    "Ferresurdotu253": "553",
    "Ferresurdotu254": "2116",
    "Ferresurdotu255": "6815",
    "Ferresurdotu256": "5280",
    "Ferresurdotu257": "8855",
    "Ferresurdotu258": "12416",
    "Ferresurdotu259": "9410",
    "Ferresurdotu261": "4536",
    "Ferresurdotu263": "3301",
    "Ferresurdotu264": "1986",
    "Ferresurdotu265": "1038",
    "Ferresurdotu266": "6877",
    "Ferresurdotu267": "4483",
    "Ferresurdotu268": "1239",
    "Ferresurdotu269": "4360",
    "Ferresurdotu270": "12742",
    "Ferresurdotu271": "6799",
    "Ferresurdotu272": "9615",
    "Ferresurdotu274": "5268",
    "Ferresurdotu275": "838",
    "Ferresurdotu276": "9985",
    "Ferresurdotu277": "7480",
    "Ferresurdotu278": "9208",
    "Ferresurdotu279": "12182",
    "Ferresurdotu280": "7982",
    "Ferresurdotu281": "8530",
    "Ferresurdotu282": "13008",
    "Ferresurdotu283": "1506",
    "Ferresurdotu284": "10063",
    "Ferresurdotu285": "4091",
    "Ferresurdotu286": "2411",
    "Ferresurdotu287": "2470",
    "Ferresurdotu289": "11547",
    "Ferresurdotu290": "13238",
    "Ferresurdotu291": "8639",
    "Ferresurdotu292": "1685",
    "Ferresurdotu293": "4514",
    "Ferresurdotu294": "10835",
    "Ferresurdotu295": "13186",
    "Ferresurdotu297": "1987",
    "Ferresurdotu298": "7245",
    "Ferresurdotu299": "4884",
    "Ferresurdotu300": "3341",
    "Ferresurdotu302": "888",
    "Ferresurdotu303": "5279",
    "Ferresurdotu304": "3940",
    "Ferresurdotu305": "791",
    "Ferresurdotu306": "88",
    "Ferresurdotu307": "5163",
    "Ferresurdotu308": "3065",
    "Ferresurdotu309": "11272",
    "Ferresurdotu311": "11404",
    "Ferresurdotu312": "10107",
    "Ferresurdotu313": "12668",
    "Ferresurdotu314": "3050",
    "Ferresurdotu315": "5675",
    "Ferresurdotu316": "13056",
    "Ferresurdotu317": "9343",
    "Ferresurdotu318": "11382",
    "Ferresurdotu319": "3434",
    "Ferresurdotu320": "8364",
    "Ferresurdotu321": "8293",
    "Ferresurdotu322": "7526",
    "Ferresurdotu324": "6903",
    "Ferresurdotu325": "12643",
    "Ferresurdotu323": "12740",
    "Ferresurdotu326": "3427",
    "Ferresurdotu328": "10935",
    "Ferresurdotu329": "9749",
    "Ferresurdotu330": "10276",
    "Ferresurdotu327": "2704",
    "Ferresurdotu331": "12089",
    "Ferresurdotu332": "1613",
    "Ferresurdotu333": "7296",
    "Ferresurdotu334": "10992",
    "Ferresurdotu335": "9611",
    "Ferresurdotu337": "4829",
    "Ferresurdotu338": "10964",
    "Ferresurdotu339": "6596",
    "Ferresurdotu340": "10772",
    "Ferresurdotu341": "11099",
    "Ferresurdotu342": "1313",
    "Ferresurdotu343": "9888",
    "Ferresurdotu344": "1313",
    "Ferresurdotu345": "13137",
    "Ferresurdotu346": "7267",
    "Ferresurdotu349": "1469",
    "Ferresurdotu350": "11172",
    "Ferresurdotu351": "5367",
    "Ferresurdotu352": "7748",
    "Ferresurdotu353": "844",
    "Ferresurdotu354": "7435",
    "Ferresurdotu355": "4191",
    "Ferresurdotu357": "211",
    "Ferresurdotu358": "4502",
    "Ferresurdotu359": "364",
    "Ferresurdotu360": "9436",
    "Ferresurdotu361": "6590",
    "Ferresurdotu362": "6449",
    "Ferresurdotu363": "258",
    "Ferresurdotu364": "8864",
    "Ferresurdotu365": "9687",
    "Ferresurdotu367": "2885",
    "Ferresurdotu368": "2511",
    "Ferresurdotu369": "5984",
    "Ferresurdotu371": "822",
    "Ferresurdotu374": "2628",
    "Ferresurdotu377": "9683",
    "Ferresurdotu378": "2827",
    "Ferresurdotu380": "4898",
    "Ferresurdotu384": "6641",
    "Ferresurdotu386": "11381",
    "Ferresurdotu388": "1191",
    "Ferresurdotu389": "10108",
    "Ferresurdotu391": "9668",
    "Ferresurdotu392": "4607",
    "Ferresurdotu393": "5957",
    "Ferresurdotu394": "8705",
    "Ferresurdotu395": "4631",
    "Ferresurdotu397": "1753",
    "Ferresurdotu399": "2739",
    "Ferresurdotu400": "9751",
    "Ferresurdotu401": "3233",
    "Ferresurdotu402": "3233",
    "Ferresurdotu403": "11477",
    "Ferresurdotu404": "6395",
    "Ferresurdotu405": "3223",
    "Ferresurdotu406": "4542",
    "Ferresurdotu407": "7643",
    "Ferresurdotu408": "5900",
    "Ferresurdotu409": "6182",
    "Ferresurdotu410": "12076",
    "Ferresurdotu411": "3465",
    "Ferresurdotu412": "3233",
    "Ferresurdotu413": "3233",
    "Ferresurdotu414": "2301",
    "Ferresurdotu415": "4264",
    "Ferresurdotu416": "9018",
    "Ferresurdotu418": "483",
    "Ferresurdotu419": "3685",
    "Ferresurdotu421": "3535",
    "Ferresurdotu423": "4647",
    "Ferresurdotu424": "11573",
    "Ferresurdotu425": "9449",
    "Ferresurdotu426": "6151",
    "Ferresurdotu427": "11076",
    "Ferresurdotu429": "3608",
    "Ferresurdotu430": "12264",
    "Ferresurdotu431": "12265",
    "Ferresurdotu432": "13151",
    "Ferresurdotu433": "1628",
    "Ferresurdotu435": "9841",
    "Ferresurdotu436": "9677",
    "Ferresurdotu437": "8814",
    "Ferresurdotu438": "6176",
    "Ferresurdotu439": "3364",
    "Ferresurdotu441": "4600",
    "Ferresurdotu442": "143",
    "Ferresurdotu443": "8009",
    "Ferresurdotu444": "1538",
    "Ferresurdotu445": "2222",
    "Ferresurdotu446": "6071",
    "Ferresurdotu447": "10661",
    "Ferresurdotu448": "5151",
    "Ferresurdotu449": "5241",
    "Ferresurdotu450": "3392",
    "Ferresurdotu451": "7550",
    "Ferresurdotu452": "2834",
    "Ferresurdotu453": "848",
    "Ferresurdotu454": "13401",
    "Ferresurdotu455": "9758",
    "Ferresurdotu456": "2828",
    "Ferresurdotu457": "7098",
    "Ferresurdotu458": "6261",
    "Ferresurdotu459": "10963",
    "Ferresurdotu460": "9746",
    "Ferresurdotu461": "4441",
    "Ferresurdotu464": "3024",
    "Ferresurdotu466": "3360",
    "Ferresurdotu467": "12109",
    "Ferresurdotu468": "11485",
    "Ferresurdotu469": "3151",
    "Ferresurdotu472": "7097",
    "Ferresurdotu474": "6172",
    "Ferresurdotu475": "1627",
    "Ferresurdotu476": "2171",
    "Ferresurdotu477": "12434",
    "Ferresurdotu478": "2387",
    "Ferresurdotu480": "5648",
    "Ferresurdotu481": "6783",
    "Ferresurdotu482": "8020",
    "Ferresurdotu483": "5157",
    "Ferresurdotu484": "11210",
    "Ferresurdotu486": "1354",
    "Ferresurdotu487": "1354",
    "Ferresurdotu488": "8997",
    "Ferresurdotu489": "10531",
    "Ferresurdotu490": "593",
    "Ferresurdotu491": "1658",
    "Ferresurdotu492": "1094",
    "Ferresurdotu493": "13116",
    "Ferresurdotu494": "5861",
    "Ferresurdotu496": "7049",
    "Ferresurdotu497": "12026",
    "Ferresurdotu498": "738",
    "Ferresurdotu499": "4423",
    "Ferresurdotu500": "6246",
    "Ferresurdotu501": "4321",
    "Ferresurdotu503": "1831",
    "Ferresurdotu504": "4235",
    "Ferresurdotu505": "3503",
    "Ferresurdotu506": "12179",
    "Ferresurdotu507": "610",
    "Ferresurdotu508": "3826",
    "Ferresurdotu509": "9347",
    "Ferresurdotu510": "3170",
    "Ferresurdotu511": "10349",
    "Ferresurdotu512": "5436",
    "Ferresurdotu513": "13036",
    "Ferresurdotu514": "6469",
    "Ferresurdotu515": "11250",
    "Ferresurdotu516": "2389",
    "Ferresurdotu518": "255",
    "Ferresurdotu519": "12517",
    "Ferresurdotu520": "7215",
    "Ferresurdotu521": "2013",
    "Ferresurdotu522": "9266",
    "Ferresurdotu523": "2460",
    "Ferresurdotu524": "7707",
    "Ferresurdotu525": "7826",
    "Ferresurdotu526": "1815",
    "Ferresurdotu527": "1872",
    "Ferresurdotu528": "9847",
    "Ferresurdotu529": "11154",
    "Ferresurdotu530": "822",
    "Ferresurdotu531": "11968",
    "Ferresurdotu532": "7436",
    "Ferresurdotu533": "4179",
    "Ferresurdotu534": "4281",
    "Ferresurdotu536": "2994",
    "Ferresurdotu537": "8786",
    "Ferresurdotu539": "3867",
    "Ferresurdotu540": "11111",
    "Ferresurdotu541": "7172",
    "Ferresurdotu542": "9288",
    "Ferresurdotu543": "11466",
    "Ferresurdotu544": "9202",
    "Ferresurdotu545": "581",
    "Ferresurdotu546": "1235",
    "Ferresurdotu547": "8395",
    "Ferresurdotu548": "7222",
    "Ferresurdotu549": "9205",
    "Ferresurdotu550": "6477",
    "Ferresurdotu551": "976",
    "Ferresurdotu552": "1623",
    "Ferresurdotu553": "3990",
    "Ferresurdotu554": "6455",
    "Ferresurdotu556": "11123",
    "Ferresurdotu557": "6969",
    "Ferresurdotu558": "2772",
    "Ferresurdotu559": "7345",
    "Ferresurdotu560": "7505",
    "Ferresurdotu562": "11385",
    "Ferresurdotu563": "10565",
    "Ferresurdotu564": "9908",
    "Ferresurdotu565": "9125",
    "Ferresurdotu566": "3606",
    "Ferresurdotu567": "6495",
    "Ferresurdotu568": "13028",
    "Ferresurdotu570": "4273",
    "Ferresurdotu571": "7782",
    "Ferresurdotu572": "1095",
    "Ferresurdotu574": "2087",
    "Ferresurdotu575": "8859",
    "Ferresurdotu576": "9957",
    "Ferresurdotu577": "7135"
}
price_data = []

for sku, item_id in item_skus.items():
    querystring = {"itemsIds": item_id, "format": "json"}
    headers = {
        "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:124.0) Gecko/20100101 Firefox/124.0",
        "Accept": "*/*",
        "Accept-Language": "en-US,es-CL;q=0.7,en;q=0.3",
        "Accept-Encoding": "gzip, deflate, br",
        "Origin": "https://ferreteriasur.cl",
        "Connection": "keep-alive",
        "Referer": "https://ferreteriasur.cl/",
        "Sec-Fetch-Dest": "empty",
        "Sec-Fetch-Mode": "cors",
        "Sec-Fetch-Site": "cross-site",
        "TE": "trailers"
    }
    response = requests.get(url, headers=headers, params=querystring)
    
    # Verifica si la respuesta es válida y muestra el resultado en pantalla
    if response.status_code == 200:
        data = response.json()
        if data:
            item = data[0]  # Se asume que la respuesta contiene solo un artículo
            description = item.get('Description', 'N/A')
            price = item.get('Price', 'N/A')
            print(f"SKU: {sku}, Description: {description}, Price: {price}")
            # Agregar los datos a price_data
            price_data.append({"SKU": sku, "Description": description, "Price": price})

print("Datos recolectados:")
print(price_data)

df = pd.DataFrame(data)

# Guardar el DataFrame en un archivo Excel
# nombre_archivo = "datos_productos.xlsx"  # Nombre del archivo Excel
# df.to_excel(nombre_archivo, index=False)  # El parámetro index=False evita que se incluyan los índices en el archivo Excel
# print(f"Datos guardados en {nombre_archivo}")


end_time = time.time()  # Tiempo de finalización de la ejecución
execution_time = end_time - start_time
print("Tiempo de ejecución: %.2f segundos" % execution_time)

# Valores que se pasan a Sheets
values = [[item['SKU'],item['Price']] for item in price_data]
result = sheet.values().update(spreadsheetId=SPREADSHEET_ID,
                               range='ferre_sur!A2:C',  # CAMBIAR
                               valueInputOption='USER_ENTERED',
                               body={'values': values}).execute()
print("Datos insertados correctamente")


#Fecha de Extraccion
now = datetime.datetime.now()
now_str = now.strftime('%Y-%m-%d %H:%M:%S')
data = {"":now_str}
json_data = json.dumps(data)
values = [[json_data]]
result = sheet.values().update(spreadsheetId=SPREADSHEET_ID,
							range='ferre_sur!F2',#CAMBIAR
							valueInputOption='USER_ENTERED',
							body={'values':values}).execute()


